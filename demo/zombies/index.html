<!DOCTYPE html>
<html>
<head>
<title>Zombies</title>
<style type="text/css">
body {
	margin: 0;
	padding: 0;
	overflow: hidden;
}
</style>
<script type="text/javascript" src="monogatari-0.1.0.min.js"></script>
<script>
  require( [ 'Monogatari' ], function( m ) {
    m.init( "#000" );
    startGame();
  } );

  function startGame() {
    require( [ 'Monogatari', 'go/single/Hero', 'buffer/Bullets', 'buffer/Zombies', 'util/Collider' ],
        function( m, Hero, Bullets, Zombies, Collider ) {

          var score = 0;
          var gameOver = false;

          m.world.update = function() {
            if ( !gameOver ) {
              Zombies.spawn();
              score = Collider.checkCollisions( score );

              if ( Hero.dead ) {
                gameOver = true;
                Zombies.clear();

                var zombiesKilled = score + ' zombies killed.';
                if ( score === 0 ) {
                  zombiesKilled = 'No zombies killed.';
                }
                if ( score === 1 ) {
                  zombiesKilled = '1 zombie killed.';
                }

                var restart = confirm( 'You died!\n\n' //
                    + zombiesKilled + '\n\n' //
                    + 'Start again?' );

                if ( restart ) {
                  location.reload();
                }
              }
            }
          };

          m.run();
        } );
  }
</script>
</head>
<body>
</body>
</html>
